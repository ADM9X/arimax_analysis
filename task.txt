明白，我将更新任务清单，加入滚动预测评估方法，实现在线学习模式的ARIMAX模型构建。

# ARIMAX模型构建与滚动预测评估任务清单

## 一、数据读取阶段
1. 读取已清洗好的数据
   - 读取data.csv文件
   - 将数据转换为时间序列格式（ts或xts对象）
   - 划分训练集（前N-12期数据）和验证集（最后12期数据）

## 二、时间序列特性分析阶段
1. 平稳性检验
   - 绘制AQI时间序列图，观察趋势和季节性
   - 进行ADF检验（Augmented Dickey-Fuller Test）
   - 必要时进行差分处理，直至数据平稳

2. 白噪声检验
   - 进行Ljung-Box检验
   - 分析并解释检验结果

3. 自相关分析
   - 绘制ACF（自相关函数）图
   - 绘制PACF（偏自相关函数）图
   - 根据ACF和PACF图判断可能的ARIMA模型阶数

## 三、ARIMAX模型构建阶段
1. 模型定阶
   - 基于ACF/PACF图确定初步的p、d、q值
   - 使用auto.arima函数辅助确定最佳模型阶数
   - 考虑季节性成分，确定SARIMA模型参数（如需要）

2. 初始模型拟合
   - 使用训练集数据构建基础ARIMA模型
   - 添加外生变量（温度、湿度）构建ARIMAX模型
   - 拟合模型并获取参数估计

3. 模型诊断
   - 残差分析（检查残差是否为白噪声）
   - 残差正态性检验
   - 残差自相关检验
   - 计算AIC、BIC等信息准则

## 四、滚动预测与在线学习评估阶段
1. 设置滚动预测框架
   - 初始化预测结果存储向量
   - 设置滚动窗口大小（训练集大小）

2. 实现滚动预测循环
   - 对于验证集中的每一期（共12期）：
     a. 使用当前训练集和当期X变量（温度、湿度）构建ARIMAX模型
     b. 预测下一期AQI值
     c. 将预测结果与真实值进行比较并存储
     d. 更新训练集（加入当前验证样本）
     e. 进入下一轮预测

3. 预测评估
   - 计算滚动预测的整体精度指标（MAPE）
   - 绘制滚动预测结果与真实值的对比图
   - 分析预测误差随时间的变化趋势

## 五、模型分析与可视化
1. 模型系数分析
   - 分析最终ARIMAX模型的系数及其显著性
   - 解释外生变量（温度、湿度）对AQI的影响

2. 预测结果可视化
   - 绘制滚动预测结果与真实值对比图
   - 为最后一次预测创建扇形图（包含置信区间）
   - 分析预测准确性随预测步长的变化

## 六、分析报告更新阶段（全部迁移到md文档）
1. 完成"模型构建"部分
   - 详细描述模型构建过程（平稳性检验、白噪声检验、ACF/PACF分析等）
   - 说明模型参数选择理由
   - 解释外生变量（温度、湿度）的影响

2. 添加"滚动预测与在线学习"部分
   - 说明滚动预测的实现方法
   - 分析在线学习模式下模型的预测性能
   - 讨论使用当期X变量预测下期AQI的有效性

3. 添加"模型评估与预测"部分
   - 分析模型拟合效果
   - 解释预测结果及其可靠性
   - 讨论温度、湿度等因素对AQI的影响

4. 撰写"总结"部分
   - 总结研究发现
   - 讨论模型局限性
   - 提出未来研究方向

## 七、代码实现要求
1. 使用单个R脚本文件完成所有分析
2. 在终端打印关键统计结果、模型摘要等信息
3. 将所有图表保存到本地，包括：
   - 时间序列图
   - ACF/PACF图
   - 残差分析图
   - 滚动预测结果对比图
   - 最终预测扇形图

## 八、R脚本框架
```r
# 加载必要的包
library(forecast)  # 时间序列分析和预测
library(tseries)   # 时间序列检验
library(ggplot2)   # 数据可视化
library(dplyr)     # 数据处理
library(lubridate) # 日期处理
library(xts)       # 扩展时间序列
library(Metrics)   # 模型评估指标

# 1. 读取数据
aqi_data <- read.csv("data/data.csv")

# 2. 时间序列转换
# 将日期转换为标准格式
# 创建时间序列对象

# 3. 划分训练集和验证集
# 训练集：前N-12期数据
# 验证集：最后12期数据

# 4. 时间序列特性分析
# 4.1 绘制时间序列图
# 4.2 平稳性检验(ADF检验)
# 4.3 差分处理(如需要)
# 4.4 白噪声检验
# 4.5 绘制ACF和PACF图

# 5. 初始模型构建
# 5.1 模型定阶
# 5.2 构建ARIMAX模型(使用温度、湿度作为外生变量)
# 5.3 模型诊断
# 5.4 模型参数分析

# 6. 滚动预测与在线学习评估
# 6.1 初始化存储结果的向量
predictions <- numeric(length = 12)
actual_values <- numeric(length = 12)

# 6.2 滚动预测循环
for (i in 1:12) {
  # a. 获取当前训练集
  # b. 使用当前训练集和当期X变量构建ARIMAX模型
  # c. 预测下一期AQI值
  # d. 存储预测结果和真实值
  # e. 更新训练集（加入当前验证样本）
}

# 6.3 计算预测精度指标
# 6.4 绘制滚动预测结果与真实值的对比图

# 7. 最终模型构建与分析
# 7.1 使用全部数据构建最终ARIMAX模型
# 7.2 分析模型系数及其显著性
# 7.3 预测未来几期并绘制扇形图

# 8. 保存结果和图表
```

这个更新后的任务清单专注于实现滚动预测和在线学习模式的ARIMAX模型评估。通过这种方式，模型将使用当期的温度和湿度数据来预测下一期的AQI值，并在每次预测后更新训练数据，模拟实际应用中的在线学习过程。这种评估方法能更准确地反映模型在实际应用中的预测性能。